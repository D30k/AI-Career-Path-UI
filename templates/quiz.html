<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Pathway AI - Career Assessment Quiz</title>
    <style>
        /* All existing styles retained */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
        body { background-color: #f0f9ff; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .modal { background-color: white; border-radius: 10px; width: 700px; box-shadow: 0 8px 20px rgba(59, 130, 246, 0.15); padding: 24px; }
        .modal-header { display: flex; justify-content: space-between; margin-bottom: 30px; }
        .progress-container { flex: 1; margin-right: 30px; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 12px; color: #64748b; }
        .progress-bar { height: 6px; background-color: #e2e8f0; border-radius: 3px; position: relative; overflow: hidden; }
        .progress-fill { position: absolute; height: 100%; background-color: #3b82f6; border-radius: 3px; transition: width 0.3s ease; }
        .step-markers { position: relative; height: 10px; display: flex; justify-content: space-between; }
        .step-marker { width: 10px; height: 10px; background-color: #e2e8f0; border-radius: 50%; margin-top: -8px; z-index: 2; transition: background-color 0.3s ease; }
        .step-marker.active { background-color: #3b82f6; }
        .step-marker.completed { background-color: #3b82f6; }
        .close-button { background: none; border: none; cursor: pointer; font-size: 16px; color: #94a3b8; }
        .modal-content { padding: 10px 0 30px; }
        h1 { font-size: 24px; color: #1e293b; margin-bottom: 25px; font-weight: 500; text-align: center; }
        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        .option-card { border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.2s; position: relative; overflow: hidden; }
        .option-card.selected { border-color: #3b82f6; box-shadow: 0 0 0 1px #3b82f6; }
        .option-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); }
        .option-image { width: 100%; height: 140px; border-radius: 6px; object-fit: cover; margin-bottom: 12px; background-color: #f8fafc; }
        .option-label { font-size: 16px; color: #334155; text-align: center; font-weight: 500; }
        .modal-footer { display: flex; justify-content: space-between; margin-top: 20px; }
        .btn { padding: 10px 20px; border-radius: 6px; font-size: 14px; cursor: pointer; font-weight: 500; transition: all 0.2s; }
        .btn-back { background: none; border: 1px solid #e2e8f0; color: #64748b; }
        .btn-back:hover { background-color: #f8fafc; }
        .btn-next { background-color: #3b82f6; border: none; color: white; }
        .btn-next.disabled { background-color: #cbd5e1; cursor: not-allowed; }
        .validation-message { color: #ef4444; text-align: center; margin-top: 15px; font-size: 14px; height: 20px; transition: opacity 0.3s; opacity: 0; }
        .validation-message.show { opacity: 1; }
        .quiz-results { text-align: center; padding: 30px 0 40px; }
        .quiz-results h2 { font-size: 28px; margin-bottom: 20px; color: #3b82f6; }
        .quiz-results pre { text-align: left; white-space: pre-wrap; word-wrap: break-word; color: #475569; }
    </style>
</head>
<body>
    <div class="modal">
        <div class="modal-header">
            <div class="progress-container">
                <div class="progress-label">
                    <span>Question <span id="current-step">1</span> of <span id="total-steps">10</span></span>
                    <span><span id="progress-percentage">10</span>% Complete</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 10%;"></div>
                </div>
                <div class="step-markers" id="step-markers"></div>
            </div>
            <button class="close-button" onclick="window.location='/'">✕</button>
        </div>
        <div class="modal-content" id="question-container"></div>
        <div class="validation-message" id="validation-message">Please select an answer before proceeding.</div>
        <div class="modal-footer">
            <button class="btn btn-back" id="prev-btn">Previous</button>
            <button class="btn btn-next disabled" id="next-btn">Next →</button>
        </div>
    </div>

    <script>
        const quizData = [
            { question: "Which work environment do you prefer?", options: [
                { text: "Traditional 9 to 5" },
                { text: "Flexible (Hybrid, Varied Hours)" },
                { text: "Collaborative Team Setting" },
                { text: "Creative Studio Environment" }
            ] },
            { question: "How do you prefer to solve problems?", options: [
                { text: "Analytical and Methodical" },
                { text: "Creative and Innovative" },
                { text: "Practical and Hands-on" },
                { text: "Collaborative and Discussion-based" }
            ] },
            { question: "Which skills would you most like to develop?", options: [
                { text: "Technical and Digital Skills" },
                { text: "Leadership and Management" },
                { text: "Creative and Design Skills" },
                { text: "Communication and Interpersonal" }
            ] },
            { question: "What type of work motivates you most?", options: [
                { text: "Helping and Supporting Others" },
                { text: "Building and Creating Things" },
                { text: "Analyzing and Solving Problems" },
                { text: "Leading and Influencing Others" }
            ] },
            { question: "What work-life balance preference do you have?", options: [
                { text: "Strict Separation Between Work and Personal" },
                { text: "Flexible Integration of Work and Personal" },
                { text: "Project-based with Intensive and Relaxed Periods" },
                { text: "Regular Schedule with Moderate Flexibility" }
            ] },
            { question: "Which industry interests you most?", options: [
                { text: "Technology and IT" },
                { text: "Healthcare and Wellness" },
                { text: "Creative Industries and Media" },
                { text: "Business and Finance" }
            ] },
            { question: "How important is income potential in your career choice?", options: [
                { text: "Very Important - Seeking High Earning Potential" },
                { text: "Moderately Important - Balance with Other Factors" },
                { text: "Less Important - Prioritize Fulfillment" },
                { text: "Varies - Depends on Life Stage" }
            ] },
            { question: "How do you prefer to learn new skills?", options: [
                { text: "Formal Education and Training" },
                { text: "Self-directed Learning" },
                { text: "On-the-job Experience" },
                { text: "Mentorship and Guidance" }
            ] },
            { question: "Which work culture appeals to you most?", options: [
                { text: "Fast-paced and Innovative" },
                { text: "Structured and Organized" },
                { text: "Supportive and Collaborative" },
                { text: "Independent and Autonomous" }
            ] },
            { question: "What level of responsibility do you prefer?", options: [
                { text: "Leadership with Strategic Decision-making" },
                { text: "Independent Specialist/Expert Role" },
                { text: "Team Member with Shared Responsibility" },
                { text: "Project Management with Defined Goals" }
            ] }
        ];

        let currentQuestion = 0;
        const totalQuestions = quizData.length;
        const userAnswers = Array(totalQuestions).fill(null);

        const questionContainer = document.getElementById('question-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const validationMessage = document.getElementById('validation-message');

        function initQuiz() {
            document.getElementById('total-steps').textContent = totalQuestions;
            const markers = document.getElementById('step-markers');
            for (let i = 0; i < totalQuestions; i++) {
                const m = document.createElement('div'); m.className = i === 0 ? 'step-marker active' : 'step-marker';
                markers.appendChild(m);
            }
            showQuestion(0);
        }

        function showQuestion(idx) {
            currentQuestion = idx;
            const q = quizData[idx];
            document.getElementById('current-step').textContent = idx + 1;
            document.getElementById('progress-percentage').textContent = Math.round(((idx+1)/totalQuestions)*100);
            document.querySelector('.progress-fill').style.width = `${((idx+1)/totalQuestions)*100}%`;
            document.querySelectorAll('.step-marker').forEach((m,i) => {
                m.className = 'step-marker' + (i<idx?' completed':'') + (i===idx?' active':'');
            });

            let html = `<h1>${q.question}</h1><div class="options">`;
            q.options.forEach((opt,i) => {
                const sel = userAnswers[idx]===opt.text ? ' selected':'';
                html += `<div class="option-card${sel}" onclick="selectAnswer(${i})"><div class="option-label">${opt.text}</div></div>`;
            });
            html += `</div>`;
            questionContainer.innerHTML = html;
            prevBtn.disabled = idx===0;
            nextBtn.textContent = idx<totalQuestions-1?'Next →':'Submit';
            updateNextButtonState();
        }

        function selectAnswer(i) {
            userAnswers[currentQuestion] = quizData[currentQuestion].options[i].text;
            showQuestion(currentQuestion);
        }

        function updateNextButtonState() {
            if (!userAnswers[currentQuestion]) nextBtn.classList.add('disabled');
            else nextBtn.classList.remove('disabled');
        }

        function showValidation() {
            validationMessage.classList.add('show');
            setTimeout(()=>validationMessage.classList.remove('show'),1500);
        }

        function mapAnswers() {
            const out = {};
            quizData.forEach((q,i)=> out[q.question]=userAnswers[i]);
            return out;
        }

        function submitAnswers() {
            fetch('/submit-quiz', {
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body: JSON.stringify({answers: mapAnswers()})
            })
            .then(r=>r.json())
            .then(data=> displayResult(data.result))
            .catch(e=> alert('Error: '+e));
        }

        function displayResult(text) {
            questionContainer.innerHTML = `<div class="quiz-results"><h2>Your AI Recommendations</h2><pre>${text}</pre></div>`;
            document.querySelector('.modal-footer').style.display='none';
        }

        prevBtn.addEventListener('click', ()=>{
            if(currentQuestion>0) showQuestion(currentQuestion-1);
        });
        nextBtn.addEventListener('click', ()=>{
            if(!userAnswers[currentQuestion]) return showValidation();
            if(currentQuestion<totalQuestions-1) showQuestion(currentQuestion+1);
            else submitAnswers();
        });

        window.onload = initQuiz;
    </script>
</body>
</html>
